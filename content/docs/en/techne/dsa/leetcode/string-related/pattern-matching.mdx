---
title: Pattern Matching
slug: pattern-matching
---

- **Naive search** – Slide pattern and compare characters, O(nm).
- **KMP** – Precompute prefix-function (`next` array) capturing longest proper prefix that’s also suffix. When mismatch occurs, shift pattern by `next[j]` instead of backtracking text pointer.

```cpp
vector<int> buildNext(const string& p) {
    vector<int> nxt(p.size()+1, -1);
    int j = -1;
    for (int i = 0; i < p.size();) {
        if (j == -1 || p[i] == p[j]) nxt[++i] = ++j;
        else j = nxt[j];
    }
    return nxt;
}

int kmp(const string& s, const string& p) {
    if (p.empty()) return 0;
    auto nxt = buildNext(p);
    int i = 0, j = 0;
    while (i < s.size()) {
        if (j == -1 || s[i] == p[j]) { ++i; ++j; }
        else j = nxt[j];
        if (j == p.size()) return i - j;
    }
    return -1;
}
```
